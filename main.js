!function(){"use strict";class e{constructor(e,t){this._config=e,this._formElement=t}enableValidation(){this._setEventListeners()}_setEventListeners(){this._inputs=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector),this.toggleButtonState(),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}_disableSubmitButton(){this._buttonElement.disabled=!0}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._disableSubmitButton()):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_checkInputValidity(e){e.validity.valid?(this._removeErrorStyles(e,this._config),this._removeErrorMessage(e)):(this._addErrorStyles(e,this._config),this._addErrorMessage(e))}_hasInvalidInput(){return this._inputs.some((e=>!e.validity.valid))}_addErrorMessage(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._config.errorTextVisible)}_removeErrorMessage(e){this._formElement.querySelector("#".concat(e.id,"-error")).classList.remove(this._config.errorTextVisible)}_removeErrorStyles(e){e.classList.remove(this._config.inputWithError)}_addErrorStyles(e){e.classList.add(this._config.inputWithError)}}class t{constructor(e,t){let{data:o,handlePictureClick:i}=e;this._text=o.title,this._link=o.url,this._handlePictureClick=i,this._cardSelector=t}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".element__photo").addEventListener("click",(()=>this._handlePictureClick({url:this._link,title:this._text}))),this._element.querySelector(".element__like-button").addEventListener("click",(()=>this._handleLikeClick())),this._element.querySelector(".element__trash").addEventListener("click",(()=>this._handleTrashButtonClick()))}previewPicture(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__photo").src=this._link,this._element.querySelector(".element__title").textContent=this._text,this._element.querySelector(".element__photo").alt=this._text,this._element}_handleLikeClick(){this._element.querySelector(".element__like-button").classList.toggle("element__like-button_activated")}_handleTrashButtonClick(){this._element.remove()}}var o=class{constructor(e){this._modal=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.closeModal()}setEventListeners(){this._modal.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close-button"))&&this.closeModal()}))}openModal(){this._modal.classList.add("modal_open"),document.addEventListener("keydown",this._handleEscClose)}closeModal(){this._modal.classList.remove("modal_open"),document.removeEventListener("keydown",this._handleEscClose)}},i=class extends o{constructor(e){let{popupSelector:t,handleFormSubmit:o}=e;super(t),this._popupForm=this._modal.querySelector(".modal__form"),this._handleFormSubmit=o}_getInputValues(){return this._inputList=this._modal.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){this._modal.addEventListener("submit",(e=>{this._handleFormSubmit(this._getInputValues()),this.closeModal(),e.preventDefault()})),super.setEventListeners()}closeModal(){this._popupForm.reset(),super.closeModal()}};const s=document.querySelector("#open-modal-button"),r=document.forms["edit-profile-form"],l=r.name,n=r.description,a=(document.querySelector("#add-card-form"),document.querySelector(".profile__add-button")),c=document.querySelector("#add-card-modal"),d={formSelector:".modal__form",inputSelector:".modal__input",errorTextSelector:".modal__error-text",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputWithError:"modal__input_has-error",errorTextVisible:"modal__error-text_visible"};new e(d,document.querySelector("#edit-profile-modal")).enableValidation();const m=new e(d,c);m.enableValidation();const _=new class{constructor(e){let{profileNameSelector:t,profileDescriptionSelector:o}=e;this._profileNameEl=document.querySelector(t),this._profileDescriptionEl=document.querySelector(o)}getUserInfo(){return{profileName:this._profileNameEl.textContent,profileDescription:this._profileDescriptionEl.textContent}}setUserInfo(e){let{profileName:t,profileDescription:o}=e;this._profileNameEl.textContent=t,this._profileDescriptionEl.textContent=o}}({profileNameSelector:"#profile-name",profileDescriptionSelector:"#profile-description"}),u=new i({popupSelector:"#edit-profile-modal",handleFormSubmit:e=>{_.setUserInfo(e)}});s.addEventListener("click",(()=>{const e=_.getUserInfo();l.value=e.profileName,n.value=e.profileDescription,u.openModal(e)}));const h=new class extends o{constructor(e){super(e),this._imageElement=this._modal.querySelector(".modal__image"),this._imageCaption=this._modal.querySelector(".modal__caption")}openModal(e){this._imageElement.src=e.url,this._imageElement.alt="Image ".concat(e.title),this._imageCaption.textContent=e.title,super.openModal()}}("#image-modal"),p=e=>{const o=new t({data:e,handlePictureClick:e=>{h.openModal(e)}},"#element-template");return o.previewPicture()},E=new class{constructor(e,t){let{items:o,renderer:i}=e;this._items=o,this._renderer=i,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{title:"Yosemite Valley",url:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{title:"Lake Louise",url:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{title:"Bald Mountains",url:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{title:"Latemar",url:"https://code.s3.yandex.net/web-code/latemar.jpg"},{title:"Vanoise National Park",url:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{title:"Lago di Braies",url:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:e=>{E.addItem(p(e))}},".elements");E.renderItems();const f=new i({popupSelector:"#add-card-modal",handleFormSubmit:e=>{E.addItem(p(e))}});a.addEventListener("click",(()=>{f.openModal(),m.toggleButtonState()})),h.setEventListeners(),u.setEventListeners(),f.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQU8sTUFBTUEsRUFDWEMsWUFBWUMsRUFBUUMsR0FDbEJDLEtBQUtDLFFBQVVILEVBQ2ZFLEtBQUtFLGFBQWVILEVBR3RCSSxtQkFDRUgsS0FBS0kscUJBR1BBLHFCQUNFSixLQUFLSyxRQUFVQyxNQUFNQyxLQUNuQlAsS0FBS0UsYUFBYU0saUJBQWlCUixLQUFLQyxRQUFRUSxnQkFHbERULEtBQUtVLGVBQWlCVixLQUFLRSxhQUFhUyxjQUN0Q1gsS0FBS0MsUUFBUVcsc0JBR2ZaLEtBQUthLG9CQUNMYixLQUFLSyxRQUFRUyxTQUFTQyxJQUNwQkEsRUFBTUMsaUJBQWlCLFNBQVMsS0FDOUJoQixLQUFLaUIsb0JBQW9CRixHQUN6QmYsS0FBS2EsMEJBS1hLLHVCQUNFbEIsS0FBS1UsZUFBZVMsVUFBVyxFQUdqQ04sb0JBQ01iLEtBQUtvQixvQkFDUHBCLEtBQUtVLGVBQWVXLFVBQVVDLElBQUl0QixLQUFLQyxRQUFRc0IscUJBQy9DdkIsS0FBS2tCLHlCQUVMbEIsS0FBS1UsZUFBZVcsVUFBVUcsT0FBT3hCLEtBQUtDLFFBQVFzQixxQkFDbER2QixLQUFLVSxlQUFlUyxVQUFXLEdBSW5DRixvQkFBb0JGLEdBQ2RBLEVBQU1VLFNBQVNDLE9BQ2pCMUIsS0FBSzJCLG1CQUFtQlosRUFBT2YsS0FBS0MsU0FDcENELEtBQUs0QixvQkFBb0JiLEtBRXpCZixLQUFLNkIsZ0JBQWdCZCxFQUFPZixLQUFLQyxTQUNqQ0QsS0FBSzhCLGlCQUFpQmYsSUFJMUJLLG1CQUNFLE9BQU9wQixLQUFLSyxRQUFRMEIsTUFBTWhCLElBQ2hCQSxFQUFNVSxTQUFTQyxRQUkzQkksaUJBQWlCZixHQUNmLE1BQU1pQixFQUFZaEMsS0FBS0UsYUFBYVMsY0FBbEIsV0FBb0NJLEVBQU1rQixHQUExQyxXQUVsQkQsRUFBVUUsWUFBY25CLEVBQU1vQixrQkFDOUJILEVBQVVYLFVBQVVDLElBQUl0QixLQUFLQyxRQUFRbUMsa0JBR3ZDUixvQkFBb0JiLEdBQ0FmLEtBQUtFLGFBQWFTLGNBQWxCLFdBQW9DSSxFQUFNa0IsR0FBMUMsV0FDUlosVUFBVUcsT0FBT3hCLEtBQUtDLFFBQVFtQyxrQkFHMUNULG1CQUFtQlosR0FDakJBLEVBQU1NLFVBQVVHLE9BQU94QixLQUFLQyxRQUFRb0MsZ0JBR3RDUixnQkFBZ0JkLEdBQ2RBLEVBQU1NLFVBQVVDLElBQUl0QixLQUFLQyxRQUFRb0MsaUJDM0U5QixNQUFNQyxFQUNYekMsWUFBWSxFQUE4QjBDLEdBQWMsSUFBNUMsS0FBRUMsRUFBRixtQkFBUUMsR0FBb0MsRUFDdER6QyxLQUFLMEMsTUFBUUYsRUFBS0csTUFDbEIzQyxLQUFLNEMsTUFBUUosRUFBS0ssSUFDbEI3QyxLQUFLOEMsb0JBQXNCTCxFQUMzQnpDLEtBQUsrQyxjQUFnQlIsRUFHdkJTLGVBTUUsT0FMYUMsU0FDVnRDLGNBQWNYLEtBQUsrQyxlQUNuQkcsUUFBUXZDLGNBQWMsWUFDdEJ3QyxXQUFVLEdBS2YvQyxxQkFDRUosS0FBS29ELFNBQ0Z6QyxjQUFjLG1CQUNkSyxpQkFBaUIsU0FBUyxJQUN6QmhCLEtBQUs4QyxvQkFBb0IsQ0FDdkJELElBQUs3QyxLQUFLNEMsTUFDVkQsTUFBTzNDLEtBQUswQyxVQUlsQjFDLEtBQUtvRCxTQUNGekMsY0FBYyx5QkFDZEssaUJBQWlCLFNBQVMsSUFBTWhCLEtBQUtxRCxxQkFFeENyRCxLQUFLb0QsU0FDRnpDLGNBQWMsbUJBQ2RLLGlCQUFpQixTQUFTLElBQU1oQixLQUFLc0QsNEJBRzFDQyxpQkFRRSxPQVBBdkQsS0FBS29ELFNBQVdwRCxLQUFLZ0QsZUFDckJoRCxLQUFLSSxxQkFFTEosS0FBS29ELFNBQVN6QyxjQUFjLG1CQUFtQjZDLElBQU14RCxLQUFLNEMsTUFDMUQ1QyxLQUFLb0QsU0FBU3pDLGNBQWMsbUJBQW1CdUIsWUFBY2xDLEtBQUswQyxNQUNsRTFDLEtBQUtvRCxTQUFTekMsY0FBYyxtQkFBbUI4QyxJQUFNekQsS0FBSzBDLE1BRW5EMUMsS0FBS29ELFNBR2RDLG1CQUNFckQsS0FBS29ELFNBQ0Z6QyxjQUFjLHlCQUNkVSxVQUFVcUMsT0FBTyxrQ0FHdEJKLDBCQUNFdEQsS0FBS29ELFNBQVM1QixVQ3BCbEIsTUFsQ0EsTUFDRTNCLFlBQVk4RCxHQUNWM0QsS0FBSzRELE9BQVNYLFNBQVN0QyxjQUFjZ0QsR0FDckMzRCxLQUFLNkQsZ0JBQWtCN0QsS0FBSzZELGdCQUFnQkMsS0FBSzlELE1BR25ENkQsZ0JBQWdCRSxHQUNFLFdBQVpBLEVBQUlDLEtBQ05oRSxLQUFLaUUsYUFJVEMsb0JBQ0VsRSxLQUFLNEQsT0FBTzVDLGlCQUFpQixhQUFjK0MsS0FFdkNBLEVBQUlJLE9BQU85QyxVQUFVK0MsU0FBUyxVQUM5QkwsRUFBSUksT0FBTzlDLFVBQVUrQyxTQUFTLHlCQUU5QnBFLEtBQUtpRSxnQkFLWEksWUFDRXJFLEtBQUs0RCxPQUFPdkMsVUFBVUMsSUFBSSxjQUMxQjJCLFNBQVNqQyxpQkFBaUIsVUFBV2hCLEtBQUs2RCxpQkFHNUNJLGFBQ0VqRSxLQUFLNEQsT0FBT3ZDLFVBQVVHLE9BQU8sY0FDN0J5QixTQUFTcUIsb0JBQW9CLFVBQVd0RSxLQUFLNkQsbUJDSWpELEVBaENBLGNBQTRCVSxFQUMxQjFFLFlBQVksR0FBcUMsSUFBckMsY0FBRThELEVBQUYsaUJBQWlCYSxHQUFvQixFQUMvQ0MsTUFBTWQsR0FFTjNELEtBQUswRSxXQUFhMUUsS0FBSzRELE9BQU9qRCxjQUFjLGdCQUM1Q1gsS0FBSzJFLGtCQUFvQkgsRUFFM0JJLGtCQU9FLE9BTkE1RSxLQUFLNkUsV0FBYTdFLEtBQUs0RCxPQUFPcEQsaUJBQWlCLGlCQUUvQ1IsS0FBSzhFLFlBQWMsR0FDbkI5RSxLQUFLNkUsV0FBVy9ELFNBQVNDLElBQ3ZCZixLQUFLOEUsWUFBWS9ELEVBQU1nRSxNQUFRaEUsRUFBTWlFLFNBRWhDaEYsS0FBSzhFLFlBR2RaLG9CQUNFbEUsS0FBSzRELE9BQU81QyxpQkFBaUIsVUFBV2lFLElBQ3RDakYsS0FBSzJFLGtCQUFrQjNFLEtBQUs0RSxtQkFDNUI1RSxLQUFLaUUsYUFDTGdCLEVBQUVDLG9CQUVKVCxNQUFNUCxvQkFHUkQsYUFDRWpFLEtBQUswRSxXQUFXUyxRQUNoQlYsTUFBTVIsZUN0QlYsTUFBTW1CLEVBQXlCbkMsU0FBU3RDLGNBQWMsc0JBRWhEMEUsRUFBa0JwQyxTQUFTcUMsTUFBTSxxQkFDakNDLEVBQVlGLEVBQWdCTixLQUM1QlMsRUFBbUJILEVBQWdCSSxZQUluQ0MsR0FGY3pDLFNBQVN0QyxjQUFjLGtCQUVyQnNDLFNBQVN0QyxjQUFjLHlCQUN2Q2dGLEVBQWUxQyxTQUFTdEMsY0FBYyxtQkFFdENpRixFQUFtQixDQUN2QkMsYUFBYyxlQUNkcEYsY0FBZSxnQkFDZnFGLGtCQUFtQixxQkFDbkJsRixxQkFBc0Isd0JBQ3RCVyxvQkFBcUIsZ0NBQ3JCYyxlQUFnQix5QkFDaEJELGlCQUFrQiw2QkE4QlMsSUFBSXhDLEVBQy9CZ0csRUFDQTNDLFNBQVN0QyxjQUFjLHdCQUVKUixtQkFFckIsTUFBTTRGLEVBQW1CLElBQUluRyxFQUFjZ0csRUFBa0JELEdBQzdESSxFQUFpQjVGLG1CQUVqQixNQUFNNkYsRUFBVyxJQ2pFakIsTUFDRW5HLFlBQVksR0FBcUQsSUFBckQsb0JBQUVvRyxFQUFGLDJCQUF1QkMsR0FBOEIsRUFDL0RsRyxLQUFLbUcsZUFBaUJsRCxTQUFTdEMsY0FBY3NGLEdBQzdDakcsS0FBS29HLHNCQUF3Qm5ELFNBQVN0QyxjQUNwQ3VGLEdBSUpHLGNBQ0UsTUFBTyxDQUNMQyxZQUFhdEcsS0FBS21HLGVBQWVqRSxZQUNqQ3FFLG1CQUFvQnZHLEtBQUtvRyxzQkFBc0JsRSxhQUduRHNFLFlBQVksR0FBcUMsSUFBckMsWUFBRUYsRUFBRixtQkFBZUMsR0FBc0IsRUFDL0N2RyxLQUFLbUcsZUFBZWpFLFlBQWNvRSxFQUNsQ3RHLEtBQUtvRyxzQkFBc0JsRSxZQUFjcUUsSURpRGYsQ0FDNUJOLG9CQUFxQixnQkFDckJDLDJCQUE0Qix5QkFHeEJPLEVBQW1CLElBQUlDLEVBQWMsQ0FDekMvQyxjQUFlLHNCQUNmYSxpQkFBbUJoQyxJQUNqQndELEVBQVNRLFlBQVloRSxNQUl6QjRDLEVBQXVCcEUsaUJBQWlCLFNBQVMsS0FDL0MsTUFBTTJGLEVBQWtCWCxFQUFTSyxjQUNqQ2QsRUFBVVAsTUFBUTJCLEVBQWdCTCxZQUNsQ2QsRUFBaUJSLE1BQVEyQixFQUFnQkosbUJBQ3pDRSxFQUFpQnBDLFVBQVVzQyxNQUc3QixNQUFNQyxFQUFhLElFbEZuQixjQUE2QnJDLEVBQzNCMUUsWUFBWThELEdBQ1ZjLE1BQU1kLEdBQ04zRCxLQUFLNkcsY0FBZ0I3RyxLQUFLNEQsT0FBT2pELGNBQWMsaUJBQy9DWCxLQUFLOEcsY0FBZ0I5RyxLQUFLNEQsT0FBT2pELGNBQWMsbUJBR2pEMEQsVUFBVTdCLEdBQ1J4QyxLQUFLNkcsY0FBY3JELElBQU1oQixFQUFLSyxJQUM5QjdDLEtBQUs2RyxjQUFjcEQsSUFBbkIsZ0JBQWtDakIsRUFBS0csT0FDdkMzQyxLQUFLOEcsY0FBYzVFLFlBQWNNLEVBQUtHLE1BQ3RDOEIsTUFBTUosY0Z1RTRCLGdCQUVoQzBDLEVBQWN2RSxJQUNsQixNQUFNd0UsRUFBTyxJQUFJMUUsRUFDZixDQUNFRSxLQUFBQSxFQUNBQyxtQkFBcUJELElBQ25Cb0UsRUFBV3ZDLFVBQVU3QixLQUd6QixxQkFFRixPQUFPd0UsRUFBS3pELGtCQUdSMEQsRUFBYyxJR25HYixNQUNMcEgsWUFBWSxFQUFxQnFILEdBQW1CLElBQXhDLE1BQUVDLEVBQUYsU0FBU0MsR0FBK0IsRUFDbERwSCxLQUFLcUgsT0FBU0YsRUFDZG5ILEtBQUtzSCxVQUFZRixFQUNqQnBILEtBQUt1SCxXQUFhdEUsU0FBU3RDLGNBQWN1RyxHQUczQ00sY0FDRXhILEtBQUtxSCxPQUFPdkcsU0FBUzJHLElBQ25CekgsS0FBS3NILFVBQVVHLE1BSW5CQyxRQUFRQyxHQUNOM0gsS0FBS3VILFdBQVdLLFFBQVFELEtIc0YxQixDQUNFUixNQXhFaUIsQ0FDbkIsQ0FDRXhFLE1BQU8sa0JBQ1BFLElBQUssb0RBRVAsQ0FDRUYsTUFBTyxjQUNQRSxJQUFLLHVEQUVQLENBQ0VGLE1BQU8saUJBQ1BFLElBQUssMERBRVAsQ0FDRUYsTUFBTyxVQUNQRSxJQUFLLG1EQUVQLENBQ0VGLE1BQU8sd0JBQ1BFLElBQUssbURBRVAsQ0FDRUYsTUFBTyxpQkFDUEUsSUFBSyxpREFrREx1RSxTQUFXNUUsSUFDVHlFLEVBQVlTLFFBQVFYLEVBQVd2RSxNQUduQyxhQUdGeUUsRUFBWU8sY0FFWixNQUFNSyxFQUFlLElBQUluQixFQUFjLENBQ3JDL0MsY0FBZSxrQkFDZmEsaUJBQW1CaEMsSUFDakJ5RSxFQUFZUyxRQUFRWCxFQUFXdkUsT0FJbkNrRCxFQUFjMUUsaUJBQWlCLFNBQVMsS0FDdEM2RyxFQUFheEQsWUFDYjBCLEVBQWlCbEYsdUJBR25CK0YsRUFBVzFDLG9CQUNYdUMsRUFBaUJ2QyxvQkFDakIyRCxFQUFhM0Qsb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2NvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICAgICk7XG5cbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG5cbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9kaXNhYmxlU3VibWl0QnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpIHtcbiAgICBpZiAoaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUVycm9yU3R5bGVzKGlucHV0LCB0aGlzLl9jb25maWcpO1xuICAgICAgdGhpcy5fcmVtb3ZlRXJyb3JNZXNzYWdlKGlucHV0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYWRkRXJyb3JTdHlsZXMoaW5wdXQsIHRoaXMuX2NvbmZpZyk7XG4gICAgICB0aGlzLl9hZGRFcnJvck1lc3NhZ2UoaW5wdXQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0cy5zb21lKChpbnB1dCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIF9hZGRFcnJvck1lc3NhZ2UoaW5wdXQpIHtcbiAgICBjb25zdCBmb3JtRXJyb3IgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICAvL1JlcGxhY2UgdGhlIGNvbnRlbnQgb2YgdGhlIGVycm9yXG4gICAgZm9ybUVycm9yLnRleHRDb250ZW50ID0gaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZm9ybUVycm9yLmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yVGV4dFZpc2libGUpO1xuICB9XG5cbiAgX3JlbW92ZUVycm9yTWVzc2FnZShpbnB1dCkge1xuICAgIGNvbnN0IGZvcm1FcnJvciA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGZvcm1FcnJvci5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvclRleHRWaXNpYmxlKTtcbiAgfVxuXG4gIF9yZW1vdmVFcnJvclN0eWxlcyhpbnB1dCkge1xuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0V2l0aEVycm9yKTtcbiAgfVxuXG4gIF9hZGRFcnJvclN0eWxlcyhpbnB1dCkge1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0V2l0aEVycm9yKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZVBpY3R1cmVDbGljayB9LCBjYXJkU2VsZWN0b3IpIHtcbiAgICB0aGlzLl90ZXh0ID0gZGF0YS50aXRsZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS51cmw7XG4gICAgdGhpcy5faGFuZGxlUGljdHVyZUNsaWNrID0gaGFuZGxlUGljdHVyZUNsaWNrO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3Bob3RvXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICAgIHRoaXMuX2hhbmRsZVBpY3R1cmVDbGljayh7XG4gICAgICAgICAgdXJsOiB0aGlzLl9saW5rLFxuICAgICAgICAgIHRpdGxlOiB0aGlzLl90ZXh0LFxuICAgICAgICB9KVxuICAgICAgKTtcblxuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2VDbGljaygpKTtcblxuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RyYXNoXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZVRyYXNoQnV0dG9uQ2xpY2soKSk7XG4gIH1cblxuICBwcmV2aWV3UGljdHVyZSgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3Bob3RvXCIpLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fcGhvdG9cIikuYWx0ID0gdGhpcy5fdGV4dDtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX2hhbmRsZUxpa2VDbGljaygpIHtcbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlLWJ1dHRvblwiKVxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmF0ZWRcIik7XG4gIH1cblxuICBfaGFuZGxlVHJhc2hCdXR0b25DbGljaygpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICB9XG59XG4iLCJjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9tb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9tb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG9wZW5Nb2RhbCgpIHtcbiAgICB0aGlzLl9tb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlblwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG5cbiAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9tb2RhbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNsb3NlTW9kYWwoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2VNb2RhbCgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcblxuY29uc3Qgb3BlblByb2ZpbGVNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3Blbi1tb2RhbC1idXR0b25cIik7XG5cbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlLWZvcm1cIl07XG5jb25zdCBuYW1lSW5wdXQgPSBlZGl0UHJvZmlsZUZvcm0ubmFtZTtcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZUZvcm0uZGVzY3JpcHRpb247XG5cbmNvbnN0IG5ld0NhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xuXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcblxuY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgZXJyb3JUZXh0U2VsZWN0b3I6IFwiLm1vZGFsX19lcnJvci10ZXh0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0V2l0aEVycm9yOiBcIm1vZGFsX19pbnB1dF9oYXMtZXJyb3JcIixcbiAgZXJyb3JUZXh0VmlzaWJsZTogXCJtb2RhbF9fZXJyb3ItdGV4dF92aXNpYmxlXCIsXG59O1xuXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICB0aXRsZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICB1cmw6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIHVybDogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIHRpdGxlOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgdXJsOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgdGl0bGU6IFwiTGF0ZW1hclwiLFxuICAgIHVybDogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgdGl0bGU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgdXJsOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIHVybDogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuY29uc3QgZWRpdFByb2ZpbGVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIilcbik7XG5lZGl0UHJvZmlsZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGFkZENhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBhZGRDYXJkTW9kYWwpO1xuYWRkQ2FyZFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcjogXCIjcHJvZmlsZS1uYW1lXCIsXG4gIHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yOiBcIiNwcm9maWxlLWRlc2NyaXB0aW9uXCIsXG59KTtcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XG4gIH0sXG59KTtcblxub3BlblByb2ZpbGVNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCBjdXJyZW50VXNlckluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBuYW1lSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlckluZm8ucHJvZmlsZU5hbWU7XG4gIGRlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlckluZm8ucHJvZmlsZURlc2NyaXB0aW9uO1xuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW5Nb2RhbChjdXJyZW50VXNlckluZm8pO1xufSk7XG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtbW9kYWxcIik7XG5cbmNvbnN0IGNyZWF0ZUNhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAge1xuICAgICAgZGF0YSxcbiAgICAgIGhhbmRsZVBpY3R1cmVDbGljazogKGRhdGEpID0+IHtcbiAgICAgICAgaW1hZ2VQb3B1cC5vcGVuTW9kYWwoZGF0YSk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgXCIjZWxlbWVudC10ZW1wbGF0ZVwiXG4gICk7XG4gIHJldHVybiBjYXJkLnByZXZpZXdQaWN0dXJlKCk7XG59O1xuXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XG4gICAgfSxcbiAgfSxcbiAgXCIuZWxlbWVudHNcIlxuKTtcblxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSkgPT4ge1xuICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XG4gIH0sXG59KTtcblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkUG9wdXAub3Blbk1vZGFsKCk7XG4gIGFkZENhcmRWYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbn0pO1xuXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBwcm9maWxlTmFtZVNlbGVjdG9yLCBwcm9maWxlRGVzY3JpcHRpb25TZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByb2ZpbGVOYW1lOiB0aGlzLl9wcm9maWxlTmFtZUVsLnRleHRDb250ZW50LFxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uOiB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG4gIHNldFVzZXJJbmZvKHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVEZXNjcmlwdGlvbiB9KSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWVFbC50ZXh0Q29udGVudCA9IHByb2ZpbGVOYW1lO1xuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50ID0gcHJvZmlsZURlc2NyaXB0aW9uO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbiAgfVxuXG4gIG9wZW5Nb2RhbChkYXRhKSB7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEudXJsO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBgSW1hZ2UgJHtkYXRhLnRpdGxlfWA7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS50aXRsZTtcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2NvbmZpZyIsIl9mb3JtRWxlbWVudCIsImVuYWJsZVZhbGlkYXRpb24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfaW5wdXRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2hhc0ludmFsaWRJbnB1dCIsImNsYXNzTGlzdCIsImFkZCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJyZW1vdmUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3JlbW92ZUVycm9yU3R5bGVzIiwiX3JlbW92ZUVycm9yTWVzc2FnZSIsIl9hZGRFcnJvclN0eWxlcyIsIl9hZGRFcnJvck1lc3NhZ2UiLCJzb21lIiwiZm9ybUVycm9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JUZXh0VmlzaWJsZSIsImlucHV0V2l0aEVycm9yIiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsImRhdGEiLCJoYW5kbGVQaWN0dXJlQ2xpY2siLCJfdGV4dCIsInRpdGxlIiwiX2xpbmsiLCJ1cmwiLCJfaGFuZGxlUGljdHVyZUNsaWNrIiwiX2NhcmRTZWxlY3RvciIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9lbGVtZW50IiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVUcmFzaEJ1dHRvbkNsaWNrIiwicHJldmlld1BpY3R1cmUiLCJzcmMiLCJhbHQiLCJ0b2dnbGUiLCJwb3B1cFNlbGVjdG9yIiwiX21vZGFsIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImV2dCIsImtleSIsImNsb3NlTW9kYWwiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwib3Blbk1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsIl9mb3JtVmFsdWVzIiwibmFtZSIsInZhbHVlIiwiZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJvcGVuUHJvZmlsZU1vZGFsQnV0dG9uIiwiZWRpdFByb2ZpbGVGb3JtIiwiZm9ybXMiLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiZGVzY3JpcHRpb24iLCJhZGRDYXJkQnV0dG9uIiwiYWRkQ2FyZE1vZGFsIiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImVycm9yVGV4dFNlbGVjdG9yIiwiYWRkQ2FyZFZhbGlkYXRvciIsInVzZXJJbmZvIiwicHJvZmlsZU5hbWVTZWxlY3RvciIsInByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yIiwiX3Byb2ZpbGVOYW1lRWwiLCJfcHJvZmlsZURlc2NyaXB0aW9uRWwiLCJnZXRVc2VySW5mbyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJlZGl0UHJvZmlsZVBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsImN1cnJlbnRVc2VySW5mbyIsImltYWdlUG9wdXAiLCJfaW1hZ2VFbGVtZW50IiwiX2ltYWdlQ2FwdGlvbiIsImNyZWF0ZUNhcmQiLCJjYXJkIiwiY2FyZFNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiYWRkQ2FyZFBvcHVwIl0sInNvdXJjZVJvb3QiOiIifQ==